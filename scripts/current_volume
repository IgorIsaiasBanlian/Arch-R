#!/bin/bash
# Arch R - Current volume level for ES info bar
# Returns volume percentage string
# rk817 BSP codec uses "DAC Playback Volume" (not "Master" or "Playback")

# Try DAC Playback Volume (rk817 BSP codec)
vol=$(amixer sget 'DAC Playback Volume' 2>/dev/null | grep -o '\[.*%\]' | head -1 | tr -d '[]')
if [ -n "$vol" ]; then
    echo "$vol"
    exit 0
fi

# Fallback: Master control (other codecs)
vol=$(amixer sget Master 2>/dev/null | awk -F'[][]' '/Left:/ { print $2 }')
if [ -n "$vol" ]; then
    echo "$vol"
    exit 0
fi

echo "N/A"
